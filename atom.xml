<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Chad</title>
  <subtitle>ä¸€å€‹å°ä¸–ç•Œå¥½å¥‡çš„iOS Developerï¼Œæ™‚å¸¸ç©ç© Android å°ç¶ æ©Ÿå™¨äºº</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://chadchang.github.io/"/>
  <updated>2016-11-21T15:04:56.000Z</updated>
  <id>http://chadchang.github.io/</id>
  
  <author>
    <name>Chad Chang</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Common Background Practice</title>
    <link href="http://chadchang.github.io/2016/11/21/background-practices/"/>
    <id>http://chadchang.github.io/2016/11/21/background-practices/</id>
    <published>2016-11-21T15:04:56.000Z</published>
    <updated>2016-11-21T15:04:56.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.objc.io/issues/2-concurrency/common-background-practices/" target="_blank" rel="external">Common Background Practices - objc.io issue #2</a> çš„æ•´ç†ç­†è¨˜</p>
<a id="more"></a>
<h3 id="import-ä¸€å¤§çµ„è³‡æ–™-with-progress-bar">import ä¸€å¤§çµ„è³‡æ–™ with progress bar</h3>
<p>Start Import</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">ImportOperation* operation = [[ImportOperation alloc] initWithStore:<span class="keyword">self</span>.store fileName:fileName];</div><div class="line"></div><div class="line"><span class="comment">//æ³¨æ„ï¼šæ›´æ–° progress å¿…é ˆåœ¨ main thread</span></div><div class="line">operation.progressCallback = ^(<span class="keyword">float</span> progress) &#123;</div><div class="line">[[<span class="built_in">NSOperationQueue</span> mainQueue] addOperationWithBlock:^</div><div class="line">&#123;</div><div class="line">    <span class="keyword">self</span>.progressIndicator.progress = progress;</div><div class="line">&#125;];</div><div class="line">&#125;;</div><div class="line">[<span class="keyword">self</span>.operationQueue addOperation:operation];</div></pre></td></tr></table></figure>
<p>ImportOperation</p>
<figure class="highlight objc"><figcaption><span>ImportOperation.m</span></figcaption><table><tr><td class="code"><pre><div class="line"></div><div class="line">- (<span class="keyword">id</span>)initWithStore:(Store*)store fileName:(<span class="built_in">NSString</span>*)name</div><div class="line">&#123;</div><div class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">self</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.store = store;</div><div class="line">        <span class="keyword">self</span>.fileName = name;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)main</div><div class="line">&#123;</div><div class="line">    <span class="comment">// <span class="doctag">TODO:</span> can we use new in the name? I think it's bad style, any ideas for a better name?</span></div><div class="line">    <span class="keyword">self</span>.context = [<span class="keyword">self</span>.store newPrivateContext];</div><div class="line">    <span class="keyword">self</span>.context.undoManager = <span class="literal">nil</span>;</div><div class="line"></div><div class="line">    [<span class="keyword">self</span>.context performBlockAndWait:^</div><div class="line">    &#123;</div><div class="line">        [<span class="keyword">self</span> import];</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)import</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSString</span>* fileContents = [<span class="built_in">NSString</span> stringWithContentsOfFile:<span class="keyword">self</span>.fileName encoding:<span class="built_in">NSUTF8StringEncoding</span> error:<span class="literal">NULL</span>];</div><div class="line">    <span class="built_in">NSArray</span>* lines = [fileContents componentsSeparatedByCharactersInSet:[<span class="built_in">NSCharacterSet</span> newlineCharacterSet]];</div><div class="line">    <span class="built_in">NSInteger</span> count = lines.count;</div><div class="line">    <span class="comment">// æ¯ 100 è¡Œæ‰æ›´æ–°ä¸€æ¬¡ progress é¿å…é˜»å¡</span></div><div class="line">    <span class="built_in">NSInteger</span> progressGranularity = count/<span class="number">100</span>;</div><div class="line">    __block <span class="built_in">NSInteger</span> idx = <span class="number">-1</span>;</div><div class="line">    [fileContents enumerateLinesUsingBlock:^(<span class="built_in">NSString</span>* line, <span class="built_in">BOOL</span>* shouldStop)</div><div class="line">    &#123;</div><div class="line">        idx++;</div><div class="line">        <span class="keyword">if</span> (idx == <span class="number">0</span>) <span class="keyword">return</span>; <span class="comment">// header line</span></div><div class="line"></div><div class="line">		 <span class="comment">// æ”¯æŒå–æ¶ˆåŠŸèƒ½</span></div><div class="line">        <span class="keyword">if</span>(<span class="keyword">self</span>.isCancelled) &#123;</div><div class="line">            *shouldStop = <span class="literal">YES</span>;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="built_in">NSArray</span>* components = [line csvComponents];</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (components.count &lt; <span class="number">5</span>) &#123;</div><div class="line">            <span class="built_in">NSLog</span>(<span class="string">@"couldn't parse: %@"</span>, components);</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        [Stop importCSVComponents:components intoContext:<span class="keyword">self</span>.context];</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (idx % progressGranularity == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">self</span>.progressCallback(idx / (<span class="keyword">float</span>) count);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (idx % ImportBatchSize == <span class="number">0</span>) &#123;</div><div class="line">            [<span class="keyword">self</span>.context save:<span class="literal">NULL</span>];</div><div class="line">        &#125;</div><div class="line">    &#125;];</div><div class="line">    <span class="keyword">self</span>.progressCallback(<span class="number">1</span>);</div><div class="line">    [<span class="keyword">self</span>.context save:<span class="literal">NULL</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="asynchronous-networking">Asynchronous Networking</h3>
<p>ä¸å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç¢¼ï¼Œå› ç‚ºä¸å¯ä»¥å–æ¶ˆï¼Œæœƒé˜»å¡ threadï¼Œåœ¨ä¸¦è¡Œæ™‚ä¹Ÿéœ€è¦å¤šä¸€å€‹ thread</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="built_in">dispatch_async</span>(backgroundQueue, ^&#123;</div><div class="line">   <span class="built_in">NSData</span>* contents = [<span class="built_in">NSData</span> dataWithContentsOfURL:url]</div><div class="line">   <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</div><div class="line">      <span class="comment">// è™•ç† data</span></div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ <code>NSURLConnection</code> or <code>NSURLSessionConnection</code> ä¾†è§£æ±º</p>
<h3 id="file-i-o-in-the-background">File I/O in the Background</h3>
<p>ç•¶æ–‡ä»¶å¤ªå¤§æ™‚ï¼Œå‰‡éœ€è¦ä¸€è¡Œä¸€è¡Œçš„è®€å–è€Œä¸æ˜¯ä¸€æ¬¡å°‡æ•´å€‹æ–‡ä»¶è®€å…¥</p>
<figure class="highlight objc"><figcaption><span>Reader</span></figcaption><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Reader</span> : <span class="title">NSObject</span></span></div><div class="line">- (<span class="keyword">void</span>)enumerateLines:(<span class="keyword">void</span> (^)(<span class="built_in">NSString</span>*))block</div><div class="line">            completion:(<span class="keyword">void</span> (^)())completion;</div><div class="line">- (<span class="keyword">id</span>)initWithFileAtPath:(<span class="built_in">NSString</span>*)path;</div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="comment">// implement</span></div><div class="line">- (<span class="keyword">void</span>)enumerateLines:(<span class="keyword">void</span> (^)(<span class="built_in">NSString</span>*))block</div><div class="line">            completion:(<span class="keyword">void</span> (^)())completion</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.queue == <span class="literal">nil</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.queue = [[<span class="built_in">NSOperationQueue</span> alloc] init];</div><div class="line">        <span class="keyword">self</span>.queue.maxConcurrentOperationCount = <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">self</span>.callback = block;</div><div class="line">    <span class="keyword">self</span>.completion = completion;</div><div class="line">    <span class="keyword">self</span>.inputStream = [<span class="built_in">NSInputStream</span> inputStreamWithURL:<span class="keyword">self</span>.fileURL];</div><div class="line">    <span class="keyword">self</span>.inputStream.delegate = <span class="keyword">self</span>;</div><div class="line">    [<span class="keyword">self</span>.inputStream scheduleInRunLoop:[<span class="built_in">NSRunLoop</span> currentRunLoop]</div><div class="line">                                forMode:<span class="built_in">NSDefaultRunLoopMode</span>];</div><div class="line">    [<span class="keyword">self</span>.inputStream open];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>inputStream çš„ delegate</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)stream:(<span class="built_in">NSStream</span>*)stream handleEvent:(<span class="built_in">NSStreamEvent</span>)eventCode</div><div class="line">&#123;</div><div class="line">    <span class="keyword">switch</span> (eventCode) &#123;</div><div class="line">        ...</div><div class="line">        <span class="keyword">case</span> <span class="built_in">NSStreamEventHasBytesAvailable</span>: &#123;</div><div class="line">            <span class="built_in">NSMutableData</span> *buffer = [<span class="built_in">NSMutableData</span> dataWithLength:<span class="number">4</span> * <span class="number">1024</span>];</div><div class="line">            <span class="built_in">NSUInteger</span> length = [<span class="keyword">self</span>.inputStream read:[buffer mutableBytes]</div><div class="line">                                             maxLength:[buffer length]];</div><div class="line">            <span class="keyword">if</span> (<span class="number">0</span> &lt; length) &#123;</div><div class="line">                [buffer setLength:length];</div><div class="line">                __<span class="keyword">weak</span> <span class="keyword">id</span> weakSelf = <span class="keyword">self</span>;</div><div class="line">                [<span class="keyword">self</span>.queue addOperationWithBlock:^&#123;</div><div class="line">                    [weakSelf processDataChunk:buffer];</div><div class="line">                &#125;];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        ...</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)processDataChunk:(<span class="built_in">NSMutableData</span> *)buffer</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.remainder != <span class="literal">nil</span>) &#123;</div><div class="line">        [<span class="keyword">self</span>.remainder appendData:buffer];</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">self</span>.remainder = buffer;</div><div class="line">    &#125;</div><div class="line">    [<span class="keyword">self</span>.remainder obj_enumerateComponentsSeparatedBy:<span class="keyword">self</span>.delimiter</div><div class="line">                                            usingBlock:^(<span class="built_in">NSData</span>* component, <span class="built_in">BOOL</span> last) &#123;</div><div class="line">        <span class="keyword">if</span> (!last) &#123;</div><div class="line">            [<span class="keyword">self</span> emitLineWithData:component];</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="number">0</span> &lt; [component length]) &#123;</div><div class="line">            <span class="keyword">self</span>.remainder = [component mutableCopy];</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">self</span>.remainder = <span class="literal">nil</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://www.objc.io/issues/2-concurrency/common-background-practices/&quot;&gt;Common Background Practices - objc.io issue #2&lt;/a&gt; çš„æ•´ç†ç­†è¨˜&lt;/p&gt;
    
    </summary>
    
    
      <category term="iOS" scheme="http://chadchang.github.io/tags/iOS/"/>
    
      <category term="objc.io" scheme="http://chadchang.github.io/tags/objc-io/"/>
    
  </entry>
  
  <entry>
    <title>Concurrent Programming çš„ API</title>
    <link href="http://chadchang.github.io/2016/11/19/objcio-2-api/"/>
    <id>http://chadchang.github.io/2016/11/19/objcio-2-api/</id>
    <published>2016-11-19T15:43:36.000Z</published>
    <updated>2016-11-20T17:32:53.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.objc.io/issues/2-concurrency/concurrency-apis-and-pitfalls/" target="_blank" rel="external">Concurrent Programming: APIs and Challenges - objc.io issue #2</a> çš„æ•´ç†ç­†è¨˜</p>
<a id="more"></a>
<p>é›£ -&gt; æ˜“ : pthreadã€NSThreadã€GCDã€NSOperationQueue</p>
<h3 id="ä½¿ç”¨-gcd">ä½¿ç”¨ GCD</h3>
<p>é è¨­æœ‰äº”å€‹ queue</p>
<ol>
<li>main queue</li>
<li>3 å€‹ä¸åŒ priority queue</li>
<li>I/O queue</li>
</ol>
<p>å¤§å¤šæ•¸æƒ…æ³ä½¿ç”¨ default çš„ priority queue å°±å¥½ï¼Œé¿å… <code>priority inversion</code></p>
<h3 id="ä½¿ç”¨-operation-queues">ä½¿ç”¨ Operation Queues</h3>
<p>å¯é€é override main or start å®šç¾©è‡ªå·±çš„ operationsã€‚</p>
<p>é‡å¯« main çš„æ–¹å¼ç•¶ return æ™‚ï¼Œé€™ operation å°±çµæŸäº†</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YourOperation</span></span></div><div class="line">    - (<span class="keyword">void</span>)main</div><div class="line">    &#123;</div><div class="line">        <span class="comment">// é€²è¡Œè™•ç† ...</span></div><div class="line">    &#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>æ›´å¤šè™•ç†æˆ–è€…è¦å¯ä»¥ asyncï¼Œé€™æƒ…æ³ä¸‹éœ€è¦æ‰‹å‹•ç®¡ç†ç‹€æ…‹ï¼Œä½¿ç”¨é è¨­çš„ setter æ‰æœƒç™¼é€ KVOï¼Œå¦å‰‡éœ€è¦è‡ªå·±ç™¼é€ã€‚</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">YourOperation</span></span></div><div class="line">    - (<span class="keyword">void</span>)start</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">self</span>.isExecuting = <span class="literal">YES</span>;</div><div class="line">        <span class="keyword">self</span>.isFinished = <span class="literal">NO</span>;</div><div class="line">        <span class="comment">// é–‹å§‹è™•ç†ï¼Œåœ¨çµæŸæ™‚æ‡‰è©²èª¿ç”¨ finished ...</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    - (<span class="keyword">void</span>)finished</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">self</span>.isExecuting = <span class="literal">NO</span>;</div><div class="line">        <span class="keyword">self</span>.isFinished = <span class="literal">YES</span>;</div><div class="line">    &#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>ç‚ºäº†ä½¿ç”¨ cancelï¼Œéœ€ä¸€ç›´æª¢æŸ¥ isCancelled å±¬æ€§ã€‚</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)main</div><div class="line">&#123;</div><div class="line">    <span class="keyword">while</span> (notDone &amp;&amp; !<span class="keyword">self</span>.isCancelled) &#123;</div><div class="line">        <span class="comment">// é€²è¡Œè™•ç†</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å°‡ operation æ”¾åˆ° queue ä¸­</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="built_in">NSOperationQueue</span> *queue = [[<span class="built_in">NSOperationQueue</span> alloc] init];</div><div class="line">YourOperation *operation = [[YourOperation alloc] init];</div><div class="line">[queue  addOperation:operation];</div></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥ç›´æ¥å°‡ block æ”¾åˆ° queue ä¸­ï¼Œä½†å®šç¾©è‡ªå·±çš„ NSOperation æœƒæ¯”è¼ƒå¥½ debugã€‚</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">[[<span class="built_in">NSOperationQueue</span> mainQueue] addOperationWithBlock:^&#123;</div><div class="line">    <span class="comment">// ä»£ç¢¼...</span></div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>NSOperation é‚„å¯ä»¥é€é <code>maxConcurrentOperationCount</code> æ§åˆ¶åŒæ™‚åŸ·è¡Œçš„æ•¸é‡ï¼Œé‚„æœ‰æ ¹æ“š queue ä¸­çš„ operation çš„ priority æ’åºï¼Œé‚„å¯ä»¥åœ¨ operation ä¹‹é–“è¨­ dependencyã€‚</p>
<p>è€Œæ€§èƒ½é›–ç„¶æ¯” GCD è¦ä½ä¸€é»ï¼Œä½†å¤§å¤šæ•¸å¯ä»¥å¿½ç•¥ä¸è¨ˆã€‚</p>
<h3 id="ä½¿ç”¨-nsthread">ä½¿ç”¨ NSThread</h3>
<p>ä½¿ç”¨é€™çš„å•é¡Œæ˜¯åœ¨æˆ‘å€‘çš„ code ä¸­ä¹Ÿåšäº†å»ºç«‹ thread çš„äº‹æƒ…ï¼Œå¯èƒ½å°è‡´ threads çˆ†ç‚¸ã€‚</p>
<figure class="highlight objc"><figcaption><span>FindMinMaxThread.h</span></figcaption><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">FindMinMaxThread</span> : <span class="title">NSThread</span></span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSUInteger</span> min;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSUInteger</span> max;</div><div class="line">- (<span class="keyword">instancetype</span>)initWithNumbers:(<span class="built_in">NSArray</span> *)numbers;</div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="comment">// FindMinMaxThread.m</span></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">FindMinMaxThread</span> </span>&#123;</div><div class="line">    <span class="built_in">NSArray</span> *_numbers;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">instancetype</span>)initWithNumbers:(<span class="built_in">NSArray</span> *)numbers</div><div class="line">&#123;</div><div class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</div><div class="line">        _numbers = numbers;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)main</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSUInteger</span> min;</div><div class="line">    <span class="built_in">NSUInteger</span> max;</div><div class="line">    <span class="comment">// é€²è¡Œç›¸é—œæ•¸æ“šçš„è™•ç†</span></div><div class="line">    <span class="keyword">self</span>.min = min;</div><div class="line">    <span class="keyword">self</span>.max = max;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>å‘¼å«çš„æ–¹å¼</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="built_in">NSMutableSet</span> *threads = [<span class="built_in">NSMutableSet</span> set];</div><div class="line"><span class="built_in">NSUInteger</span> numberCount = <span class="keyword">self</span>.numbers.count;</div><div class="line"><span class="built_in">NSUInteger</span> threadCount = <span class="number">4</span>;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="built_in">NSUInteger</span> i = <span class="number">0</span>; i &lt; threadCount; i++) &#123;</div><div class="line">    <span class="built_in">NSUInteger</span> offset = (count / threadCount) * i;</div><div class="line">    <span class="built_in">NSUInteger</span> count = MIN(numberCount - offset, numberCount / threadCount);</div><div class="line">    <span class="built_in">NSRange</span> range = <span class="built_in">NSMakeRange</span>(offset, count);</div><div class="line">    <span class="built_in">NSArray</span> *subset = [<span class="keyword">self</span>.numbers subarrayWithRange:range];</div><div class="line">    FindMinMaxThread *thread = [[FindMinMaxThread alloc] initWithNumbers:subset];</div><div class="line">    [threads addObject:thread];</div><div class="line">    [thread start];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨-pthread">ä½¿ç”¨ pthread</h3>
<p>è¤‡é›œä¸æ˜“ä½¿ç”¨</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;pthread.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">struct</span> threadInfo &#123;</div><div class="line">    uint32_t * inputValues;</div><div class="line">    size_t count;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> threadResult &#123;</div><div class="line">    uint32_t min;</div><div class="line">    uint32_t max;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">void</span> * findMinAndMax(<span class="keyword">void</span> *arg)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">struct</span> threadInfo <span class="keyword">const</span> * <span class="keyword">const</span> info = (<span class="keyword">struct</span> threadInfo *) arg;</div><div class="line">    uint32_t min = <span class="built_in">UINT32_MAX</span>;</div><div class="line">    uint32_t max = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (size_t i = <span class="number">0</span>; i &lt; info-&gt;count; ++i) &#123;</div><div class="line">        uint32_t v = info-&gt;inputValues[i];</div><div class="line">        min = MIN(min, v);</div><div class="line">        max = MAX(max, v);</div><div class="line">    &#125;</div><div class="line">    free(arg);</div><div class="line">    <span class="keyword">struct</span> threadResult * <span class="keyword">const</span> result = (<span class="keyword">struct</span> threadResult *) malloc(<span class="keyword">sizeof</span>(*result));</div><div class="line">    result-&gt;min = min;</div><div class="line">    result-&gt;max = max;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</div><div class="line">&#123;</div><div class="line">    size_t <span class="keyword">const</span> count = <span class="number">1000000</span>;</div><div class="line">    uint32_t inputValues[count];</div><div class="line"></div><div class="line">    <span class="comment">// ä½¿ç”¨éš¨æ©Ÿæ•¸å­—å¡«å…… inputValues</span></div><div class="line">    <span class="keyword">for</span> (size_t i = <span class="number">0</span>; i &lt; count; ++i) &#123;</div><div class="line">        inputValues[i] = arc4random();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// é–‹å§‹4å€‹å°‹æ‰¾æœ€å°å€¼å’Œæœ€å¤§å€¼çš„ç·šç¨‹</span></div><div class="line">    size_t <span class="keyword">const</span> threadCount = <span class="number">4</span>;</div><div class="line">    pthread_t tid[threadCount];</div><div class="line">    <span class="keyword">for</span> (size_t i = <span class="number">0</span>; i &lt; threadCount; ++i) &#123;</div><div class="line">        <span class="keyword">struct</span> threadInfo * <span class="keyword">const</span> info = (<span class="keyword">struct</span> threadInfo *) malloc(<span class="keyword">sizeof</span>(*info));</div><div class="line">        size_t offset = (count / threadCount) * i;</div><div class="line">        info-&gt;inputValues = inputValues + offset;</div><div class="line">        info-&gt;count = MIN(count - offset, count / threadCount);</div><div class="line">        <span class="keyword">int</span> err = pthread_create(tid + i, <span class="literal">NULL</span>, &amp;findMinAndMax, info);</div><div class="line">        <span class="built_in">NSCAssert</span>(err == <span class="number">0</span>, <span class="string">@"pthread_create() failed: %d"</span>, err);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// ç­‰å¾…ç·šç¨‹é€€å‡º</span></div><div class="line">    <span class="keyword">struct</span> threadResult * results[threadCount];</div><div class="line">    <span class="keyword">for</span> (size_t i = <span class="number">0</span>; i &lt; threadCount; ++i) &#123;</div><div class="line">        <span class="keyword">int</span> err = pthread_join(tid[i], (<span class="keyword">void</span> **) &amp;(results[i]));</div><div class="line">        <span class="built_in">NSCAssert</span>(err == <span class="number">0</span>, <span class="string">@"pthread_join() failed: %d"</span>, err);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// å°‹æ‰¾ min å’Œ max</span></div><div class="line">    uint32_t min = <span class="built_in">UINT32_MAX</span>;</div><div class="line">    uint32_t max = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (size_t i = <span class="number">0</span>; i &lt; threadCount; ++i) &#123;</div><div class="line">        min = MIN(min, results[i]-&gt;min);</div><div class="line">        max = MAX(max, results[i]-&gt;max);</div><div class="line">        free(results[i]);</div><div class="line">        results[i] = <span class="literal">NULL</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"min = %u"</span>, min);</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"max = %u"</span>, max);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://www.objc.io/issues/2-concurrency/concurrency-apis-and-pitfalls/&quot;&gt;Concurrent Programming: APIs and Challenges - objc.io issue #2&lt;/a&gt; çš„æ•´ç†ç­†è¨˜&lt;/p&gt;
    
    </summary>
    
    
      <category term="iOS" scheme="http://chadchang.github.io/tags/iOS/"/>
    
      <category term="objc.io" scheme="http://chadchang.github.io/tags/objc-io/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ç¾æœ‰ bootstrap æ¨£æ¿</title>
    <link href="http://chadchang.github.io/2016/11/17/startbootstrap-sb-admin-2/"/>
    <id>http://chadchang.github.io/2016/11/17/startbootstrap-sb-admin-2/</id>
    <published>2016-11-17T14:52:51.000Z</published>
    <updated>2016-11-18T14:27:28.000Z</updated>
    
    <content type="html"><![CDATA[<p>çœ‹åˆ° <a href="https://github.com/BlackrockDigital/startbootstrap-sb-admin-2" target="_blank" rel="external">startbootstrap-sb-admin-2</a> é€™æ¼‚äº®è€Œä¸”å¾ˆä½›å¿ƒæ˜¯ free ä¸” open source çš„æ¨£æ¿ (MIT license)ï¼Œå°±æŠŠè³‡æ–™æ•´åˆé€²æ­¤ç•¶åšç›®æ¨™å§ã€‚</p>
<a id="more"></a>
<p>flask-bootstrap å…§æœ‰ <a href="https://github.com/mbr/flask-bootstrap/blob/master/flask_bootstrap/templates/bootstrap/base.html" target="_blank" rel="external"><code>bootstrap/base.html</code></a>ï¼Œéœ€è¦æŠŠ startbootstrap-sb-admin-2 å…§çš„ code extend ä¸”ç²¾ç°¡ã€‚ åˆ°æ­¤æ­¥çš„ code è«‹åƒè€ƒ <a href="https://github.com/ChadChang/app_dashboard/commit/037ab362f14f3157393d5bcbdf934f4c2e58ca51" target="_blank" rel="external">commit #037ab3</a></p>
<p><em>Tips:</em></p>
<ol>
<li>åƒè€ƒåŸæœ¬ base.html çš„æ¡†æ¶ï¼Œåˆ†åˆ¥æŠ½å‡ºå³å¯</li>
<li>æ³¨æ„éœ€è¦ä½¿ç”¨ <code>{{super()}}</code>ï¼Œé¿å… override åŸæœ¬çš„è¨­å®š</li>
</ol>
<p><img src="/images/app_dashboard_init.png" alt="æ•´åˆ prototype"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;çœ‹åˆ° &lt;a href=&quot;https://github.com/BlackrockDigital/startbootstrap-sb-admin-2&quot;&gt;startbootstrap-sb-admin-2&lt;/a&gt; é€™æ¼‚äº®è€Œä¸”å¾ˆä½›å¿ƒæ˜¯ free ä¸” open source çš„æ¨£æ¿ (MIT license)ï¼Œå°±æŠŠè³‡æ–™æ•´åˆé€²æ­¤ç•¶åšç›®æ¨™å§ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Python" scheme="http://chadchang.github.io/tags/Python/"/>
    
      <category term="Flask" scheme="http://chadchang.github.io/tags/Flask/"/>
    
      <category term="App Dashboard" scheme="http://chadchang.github.io/tags/App-Dashboard/"/>
    
  </entry>
  
  <entry>
    <title>åŠ å…¥ bootstrap</title>
    <link href="http://chadchang.github.io/2016/11/10/bootstrap/"/>
    <id>http://chadchang.github.io/2016/11/10/bootstrap/</id>
    <published>2016-11-10T12:55:02.000Z</published>
    <updated>2016-11-18T14:22:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>å˜—è©¦ç”¨ <a href="http://getbootstrap.com/" target="_blank" rel="external">Bootstrap</a> ä¾†ç•¶æ•´å€‹ project çš„ç¶²é éƒ¨åˆ†</p>
<a id="more"></a>
<p>é¦–å…ˆå®‰è£ <a href="https://pythonhosted.org/Flask-Bootstrap/" target="_blank" rel="external">flask-bootstrap</a> ä¾†å»ºç«‹æœ€å°å¯ä»¥åŸ·è¡Œçš„ bootstrap web ç•«é¢</p>
<p>html éƒ¨åˆ†æœƒæ”¾åœ¨ <code>/tempalate</code> åº•ä¸‹ï¼Œè€Œå›  template çš„è®Šå‹•ä¸æœƒè‡ªå‹• reloadï¼Œå¿…é ˆé‡æ–°å•Ÿå‹• serverï¼Œåªéœ€å¢åŠ  <code>app.config['TEMPLATES_AUTO_RELOAD'] = True</code> å³å¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">pip install flask-bootstrap</div></pre></td></tr></table></figure>
<figure class="highlight python"><figcaption><span>app.py</span></figcaption><table><tr><td class="code"><pre><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,render_template</div><div class="line"><span class="keyword">from</span> flask_bootstrap  <span class="keyword">import</span> Bootstrap</div><div class="line"></div><div class="line">app = Flask(__name__)</div><div class="line">app.config[<span class="string">'TEMPLATES_AUTO_RELOAD'</span>] = <span class="keyword">True</span></div><div class="line">bootstrap = Bootstrap(app)</div><div class="line"></div><div class="line"><span class="meta">@app.route('/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    app.run(debug = <span class="keyword">True</span>)</div></pre></td></tr></table></figure>
<p>å»ºç«‹æ•´å€‹ç¶²ç«™çš„æ¨¡ç‰ˆ <code>base.html</code></p>
<figure class="highlight html"><figcaption><span>base.html</span></figcaption><table><tr><td class="code"><pre><div class="line">&#123;% extends "bootstrap/base.html"  %&#125;</div><div class="line"></div><div class="line">&#123;% block title %&#125;App Dashboard&#123;% endblock %&#125;</div><div class="line"></div><div class="line">&#123;% block navbar %&#125;</div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar navbar-inverse"</span> <span class="attr">role</span>=<span class="string">"navigation"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar-header"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"navbar-toggle"</span> <span class="attr">data-toggle</span>=<span class="string">"collapse"</span> <span class="attr">data-target</span>=<span class="string">".navbar-collapse"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>Toggle navigation<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"navbar-brand"</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span>App Dashboard<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar-collapse collapse"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">&#123;% endblock %&#125;</div><div class="line"></div><div class="line">&#123;% block content %&#125;</div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">  &#123;% block page_content %&#125;&#123;% endblock %&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">&#123;% endblock %&#125;</div></pre></td></tr></table></figure>
<p>å…¶ä»–æ¯å€‹ç•«é¢åªè¦ extends base.html å³å¯ã€‚</p>
<figure class="highlight html"><figcaption><span>index.html</span></figcaption><table><tr><td class="code"><pre><div class="line">&#123;% extends "base.html" %&#125;</div><div class="line"></div><div class="line">&#123;% block title %&#125;Main&#123;% endblock %&#125;</div><div class="line"></div><div class="line">&#123;% block page_content %&#125;</div><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Main<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">&#123;% endblock %&#125;</div></pre></td></tr></table></figure>
<p>çµæœå¦‚ä¸‹:<br>
<img src="/images/flask-bootstrap.png" alt="flask-bootstrap"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å˜—è©¦ç”¨ &lt;a href=&quot;http://getbootstrap.com/&quot;&gt;Bootstrap&lt;/a&gt; ä¾†ç•¶æ•´å€‹ project çš„ç¶²é éƒ¨åˆ†&lt;/p&gt;
    
    </summary>
    
    
      <category term="Python" scheme="http://chadchang.github.io/tags/Python/"/>
    
      <category term="Flask" scheme="http://chadchang.github.io/tags/Flask/"/>
    
      <category term="App Dashboard" scheme="http://chadchang.github.io/tags/App-Dashboard/"/>
    
  </entry>
  
  <entry>
    <title>App Dashboard Start</title>
    <link href="http://chadchang.github.io/2016/11/09/Dashboard/"/>
    <id>http://chadchang.github.io/2016/11/09/Dashboard/</id>
    <published>2016-11-09T10:07:39.000Z</published>
    <updated>2016-11-11T04:47:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ‰“ç®—è‡ªå·±åšä¸€å€‹ App ç”¨çš„ Dashboardï¼Œè¨˜éŒ„ä¸€ä¸‹ mac ç’°å¢ƒä¸­å»ºç½®çš„æ­¥é©Ÿã€‚</p>
<a id="more"></a>
<p>Mac ç’°å¢ƒä¸­çš„ Python å¯èƒ½æœ‰é»èˆŠï¼Œå…ˆç”¨ homebrew å®‰è£ Python (éœ€å…ˆå®‰è£å¥½ <a href="http://brew.sh/index_zh-tw.html" target="_blank" rel="external">Homebrew</a>)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">brew install python</div></pre></td></tr></table></figure>
<p>è€Œé¿å…èˆ‡ç³»çµ±ä¸­çš„ç’°å¢ƒæ··æ·†ï¼Œå»ºè­°å®‰è£  <a href="https://virtualenv.pypa.io/en/stable/" target="_blank" rel="external">virtualenv</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">pip install virtualenv</div></pre></td></tr></table></figure>
<p>å»ºç«‹ä¸€å€‹ virtual env</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">virtualenv python-env</div><div class="line"></div><div class="line">// å•Ÿå‹•</div><div class="line"><span class="built_in">source</span> python-env/bin/activate</div><div class="line">// é›¢é–‹</div><div class="line">deactivate</div></pre></td></tr></table></figure>
<p>å®‰è£ <a href="http://flask.pocoo.org/" target="_blank" rel="external">Flask</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">pip install Flask</div></pre></td></tr></table></figure>
<p>ä¾ç…§å®˜ç¶² sample code å»ºç«‹ <a href="http://hello.py" target="_blank" rel="external">hello.py</a></p>
<figure class="highlight python"><figcaption><span>hello.py</span></figcaption><table><tr><td class="code"><pre><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</div><div class="line">app = Flask(__name__)</div><div class="line"></div><div class="line"><span class="meta">@app.route("/")</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> <span class="string">"Hello World!"</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    app.run()</div></pre></td></tr></table></figure>
<p>åŸ·è¡Œ <code>python hello.py</code> æ‰“é–‹ç€è¦½å™¨ <a href="http://127.0.0.1:5000/" target="_blank" rel="external">http://127.0.0.1:5000/</a> å°±å¯ä»¥çœ‹åˆ°çµæœäº†</p>
<p><img src="/images/flask_hello.png" alt="hello flask"></p>
<p>å†ä¾†å¸Œæœ›å¯ä»¥è®“ Flask è®€æˆ‘å€‘çš„ html, åœ¨ project ä¸­å»ºç«‹ <code>templates</code> folder ä¸¦æ”¾å…¥ <code>index.html</code> å³å¯è®€åˆ° index.html</p>
<figure class="highlight python"><figcaption><span>hello.py</span></figcaption><table><tr><td class="code"><pre><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</div><div class="line"><span class="keyword">from</span>  flask <span class="keyword">import</span> Flask</div><div class="line">app = Flask(__name__)</div><div class="line"></div><div class="line"><span class="meta">@app.route("/")</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    app.run()</div></pre></td></tr></table></figure>
<p>è€Œåœ¨ debug æ™‚å¯ä»¥ä½¿ç”¨ <code>app.run(debug = True)</code>ï¼Œé€™æ¨£åœ¨ Python code æœ‰æ›´å‹•æ™‚ï¼Œ server æœƒè‡ªå‹• reload.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‰“ç®—è‡ªå·±åšä¸€å€‹ App ç”¨çš„ Dashboardï¼Œè¨˜éŒ„ä¸€ä¸‹ mac ç’°å¢ƒä¸­å»ºç½®çš„æ­¥é©Ÿã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Python" scheme="http://chadchang.github.io/tags/Python/"/>
    
      <category term="Flask" scheme="http://chadchang.github.io/tags/Flask/"/>
    
      <category term="App Dashboard" scheme="http://chadchang.github.io/tags/App-Dashboard/"/>
    
  </entry>
  
  <entry>
    <title>å•Ÿå‹• Side Project - App Dashboard</title>
    <link href="http://chadchang.github.io/2016/11/08/side-project/"/>
    <id>http://chadchang.github.io/2016/11/08/side-project/</id>
    <published>2016-11-08T13:24:39.000Z</published>
    <updated>2016-11-10T08:03:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ App å¯«äº† å…­ä¸ƒå¹´å¾Œï¼Œåè€Œæƒ³å†å›å»å¯«ä¸€é» Web ç­‰ä¸åŒæ–¼ App çš„æ±è¥¿ï¼Œç•¢ç«Ÿéäº†é€™éº¼å¤šå¹´ï¼Œç¾åœ¨æ•´å€‹ Web ä¸–ç•Œåˆå¤§å¤§ä¸åŒäº†ã€‚çœ‹åˆ°ç£å€æ—¥å ±çš„ä½œè€…ä¸€ç›´åœ¨æŒçºŒæ¨é€²ä»–çš„æ±è¥¿ï¼Œä¹Ÿå­¸å¯«äº† App è€Œä¸”æ›´æ–°é »ç¹ï¼Œä¸€ç›´åœ¨æƒ³è‡ªå·±æœ‰æ²’æœ‰å¯ä»¥æ•ˆæ³•ä»–å¥½å¥½åšä¸€å€‹è‡ªå·±ç”¨æœƒæ„Ÿåˆ°èˆˆå¥®çš„æ±è¥¿ã€‚åœ¨æ€è€ƒä¹‹é¤˜ï¼Œå‰›å¥½åˆåœ¨ç£å€æ—¥å ±çœ‹åˆ°äº†é€™ç¯‡ <a href="https://ponyfoo.com/articles/making-time-for-side-projects" target="_blank" rel="external">Making Time for Side Projects: A Daily Habit</a>ï¼Œæ›´ç¢ºå®šæ˜¯è©²ä¾†åšäº›ä»€éº¼äº† ğŸ˜„</p>
<ol>
<li>Itâ€™s easier to get started</li>
<li>The pressure is off</li>
<li>You stop relying on motivation &amp; inspiration</li>
</ol>
<p>ç£å€æ—¥å ±ä½œè€…çš„ç¶“é©—æˆ‘è¦ºå¾—å¾ˆå€¼å¾—å¯ä»¥åƒè€ƒ:</p>
<blockquote>
<p>æˆ‘çš„ç¶“é©—æ˜¯ï¼Œåš side project çš„è©±ï¼Œå®¶è£¡çš„é›»è…¦æ°¸é ä¸é—œæ©Ÿï¼Œæ°¸é é–‹è‘— IDEã€é–‹ç™¼ç”¨çš„è™›æ“¬æ©Ÿã€ç€è¦½å™¨çš„ DevToolsã€iTerm2 ç­‰ï¼Œæ¯å¤©æœ‰æ™‚é–“å°±åšå€‹ 1ã€2 å°æ™‚ï¼Œæ²’æ™‚é–“å¼„å€‹ 10 åˆ†é˜ã€15 åˆ†é˜æ”¹å€‹å­—é«”å¤§å°ã€é¡è‰²å•¥çš„ä¹Ÿè¡Œï¼Œä¿æŒé–‹ç™¼ç’°å¢ƒä¸è®Šï¼Œç¬¬äºŒå¤©ä¸€æœ‰ç©ºé–’å°±èƒ½æ¥ä¸‹å»å¯«ã€å¾ˆå¿«é€²å…¥ç‹€æ…‹ã€‚</p>
</blockquote>
<p>æ¯å¤©éƒ½æŠ•å…¥ä¸€é»ï¼Œå³ä¾¿åªæ˜¯äº”åˆ†é˜ååˆ†é˜ï¼Œéƒ½æ˜¯è®“é€™ project æ›´å‰é€²ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ App å¯«äº† å…­ä¸ƒå¹´å¾Œï¼Œåè€Œæƒ³å†å›å»å¯«ä¸€é» Web ç­‰ä¸åŒæ–¼ App çš„æ±è¥¿ï¼Œç•¢ç«Ÿéäº†é€™éº¼å¤šå¹´ï¼Œç¾åœ¨æ•´å€‹ Web ä¸–ç•Œåˆå¤§å¤§ä¸åŒäº†ã€‚çœ‹åˆ°ç£å€æ—¥å ±çš„ä½œè€…ä¸€ç›´åœ¨æŒçºŒæ¨é€²ä»–çš„æ±è¥¿ï¼Œä¹Ÿå­¸å¯«äº† App è€Œä¸”æ›´æ–°é »ç¹ï¼Œä¸€ç›´åœ¨æƒ³è‡ªå·±æœ‰æ²’æœ‰å¯ä»¥æ•ˆæ³•ä»–å¥½å¥½åšä¸€å€‹è‡ªå·±ç”¨æœƒæ„Ÿåˆ°èˆˆå¥®çš„æ±è¥¿ã€‚åœ¨
    
    </summary>
    
    
      <category term="App Dashboard" scheme="http://chadchang.github.io/tags/App-Dashboard/"/>
    
  </entry>
  
  <entry>
    <title>åŒä¸€å¤© App Storeã€Google Play é›™ Feature</title>
    <link href="http://chadchang.github.io/2016/10/21/feature/"/>
    <id>http://chadchang.github.io/2016/10/21/feature/</id>
    <published>2016-10-20T16:49:44.000Z</published>
    <updated>2016-11-03T17:08:03.000Z</updated>
    
    <content type="html"><![CDATA[<p>App å¾ç„¡åˆ°æœ‰çš„é–‹ç™¼ä¸‰å¹´å¤šï¼Œæ¯å¤©èˆ‡åŒäº‹å€‘çŒæº‰è‘— iOS/Android é€™å…©ç‰ˆæœ¬çš„ Appï¼Œé›–ç„¶å·²ç¶“ä¸Šæ¦œå¾ˆå¤šæ¬¡ï¼Œä½†é€™æ¬¡æ˜¯æ¯”è¼ƒé‡å¤§çš„ï¼Œä¸”å…©ç‰ˆæœ¬åŒä¸€å¤©è¢« Feature å°æˆ‘è€Œè¨€ä¹Ÿæ˜¯æŒºé›£å¾—çš„ã€‚ç™¼æ–‡ç´€å¿µä¸€ä¸‹ã€‚ä¹Ÿè¬è¬å¼·å¤§çš„åŒäº‹å€‘çš„åŠ›é‡è®“é€™ App å¯ä»¥é£›ä¸Šå¤©ç©ºã€‚</p>
<p><img src="/images/app_store_feature.jpg" alt="App Store Feature"> <img src="/images/google_play_feature.png" alt="Google Play Feature"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;App å¾ç„¡åˆ°æœ‰çš„é–‹ç™¼ä¸‰å¹´å¤šï¼Œæ¯å¤©èˆ‡åŒäº‹å€‘çŒæº‰è‘— iOS/Android é€™å…©ç‰ˆæœ¬çš„ Appï¼Œé›–ç„¶å·²ç¶“ä¸Šæ¦œå¾ˆå¤šæ¬¡ï¼Œä½†é€™æ¬¡æ˜¯æ¯”è¼ƒé‡å¤§çš„ï¼Œä¸”å…©ç‰ˆæœ¬åŒä¸€å¤©è¢« Feature å°æˆ‘è€Œè¨€ä¹Ÿæ˜¯æŒºé›£å¾—çš„ã€‚ç™¼æ–‡ç´€å¿µä¸€ä¸‹ã€‚ä¹Ÿè¬è¬å¼·å¤§çš„åŒäº‹å€‘çš„åŠ›é‡è®“é€™ App å¯ä»¥é£›ä¸Šå¤©ç©ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;
    
    </summary>
    
    
      <category term="iOS" scheme="http://chadchang.github.io/tags/iOS/"/>
    
      <category term="App Store" scheme="http://chadchang.github.io/tags/App-Store/"/>
    
      <category term="Android" scheme="http://chadchang.github.io/tags/Android/"/>
    
      <category term="Google Play" scheme="http://chadchang.github.io/tags/Google-Play/"/>
    
      <category term="Work" scheme="http://chadchang.github.io/tags/Work/"/>
    
  </entry>
  
  <entry>
    <title>GCD ç­†è¨˜</title>
    <link href="http://chadchang.github.io/2014/05/10/gcd/"/>
    <id>http://chadchang.github.io/2014/05/10/gcd/</id>
    <published>2014-05-10T04:08:00.000Z</published>
    <updated>2016-11-19T01:13:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>åƒè€ƒ <a href="http://www.raywenderlich.com/60749/grand-central-dispatch-in-depth-part-1" target="_blank" rel="external">Grand Central Dispatch In-Depth</a> çš„ç­†è¨˜ã€‚</p>
<ul>
<li>Critical Section</li>
<li>Race Condition</li>
<li>Deadlock</li>
<li>Context Switch</li>
</ul>
<a id="more"></a>
<h3 id="èƒŒæ™¯è®€å–-dispatch-async">èƒŒæ™¯è®€å– dispatch_async</h3>
<figure class="highlight objc"><figcaption><span>PhotoDetailViewController.m</span></figcaption><table><tr><td class="code"><pre><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad</div><div class="line">&#123;   </div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    <span class="built_in">NSAssert</span>(_image, <span class="string">@"Image not set; required to use view controller"</span>);</div><div class="line">    <span class="keyword">self</span>.photoImageView.image = _image;</div><div class="line"> </div><div class="line">    <span class="comment">//Resize if neccessary to ensure it's not pixelated</span></div><div class="line">    <span class="keyword">if</span> (_image.size.height &lt;= <span class="keyword">self</span>.photoImageView.bounds.size.height &amp;&amp;</div><div class="line">        _image.size.width &lt;= <span class="keyword">self</span>.photoImageView.bounds.size.width) &#123;</div><div class="line">        [<span class="keyword">self</span>.photoImageView setContentMode:<span class="built_in">UIViewContentModeCenter</span>];</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, <span class="number">0</span>), ^&#123; <span class="comment">// 1</span></div><div class="line">        <span class="built_in">UIImage</span> *overlayImage = [<span class="keyword">self</span> faceOverlayImageFromImage:_image];</div><div class="line">        <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123; <span class="comment">// 2</span></div><div class="line">            [<span class="keyword">self</span> fadeInNewImage:overlayImage]; <span class="comment">// 3</span></div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å¹¾ç§’å¾Œæç¤º-dispatch-after">å¹¾ç§’å¾Œæç¤º dispatch_after</h3>
<p><img src="/images/gcdpromotes.png" alt="GCD promote"></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)showOrHideNavPrompt PhotoCollectionViewController.m</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSUInteger</span> count = [[PhotoManager sharedManager] photos].count;</div><div class="line">    <span class="keyword">double</span> delayInSeconds = <span class="number">1.0</span>;</div><div class="line">    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delayInSeconds * <span class="built_in">NSEC_PER_SEC</span>)); <span class="comment">// 1 </span></div><div class="line">    dispatch_after(popTime, dispatch_get_main_queue(), ^(<span class="keyword">void</span>)&#123; <span class="comment">// 2 </span></div><div class="line">        <span class="keyword">if</span> (!count) &#123;</div><div class="line">            [<span class="keyword">self</span>.navigationItem setPrompt:<span class="string">@"Add photos with faces to Googlyify them!"</span>];</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            [<span class="keyword">self</span>.navigationItem setPrompt:<span class="literal">nil</span>];</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>dispatch_after æœ€å¥½ä½¿ç”¨åœ¨ main queue</strong></p>
<ul>
<li>Custom Serial Queue: Use caution when using dispatch_after on a custom serial queue. Youâ€™re better off sticking to the main queue.</li>
<li>Main Queue (Serial): This is a good choice for dispatch_after; Xcode has a nice autocomplete template for this.</li>
<li>Concurrent Queue: Use caution when using dispatch_after on custom concurrent queues; itâ€™s rare that youâ€™ll do this. Stick to the main queue for these operations.</li>
</ul>
<h3 id="singleton">Singleton</h3>
<figure class="highlight objc"><figcaption><span>PhotoManager.m</span></figcaption><table><tr><td class="code"><pre><div class="line">+ (<span class="keyword">instancetype</span>)sharedManager</div><div class="line">&#123;</div><div class="line">    <span class="keyword">static</span> PhotoManager *sharedPhotoManager = <span class="literal">nil</span>;</div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">        sharedPhotoManager = [[PhotoManager alloc] init];</div><div class="line">        sharedPhotoManager-&gt;_photosArray = [<span class="built_in">NSMutableArray</span> array];</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">return</span> sharedPhotoManager;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="è®€å¯«å•é¡Œ-dispatch-barrier">è®€å¯«å•é¡Œ dispatch_barrier</h3>
<p>å•é¡Œ</p>
<figure class="highlight objc"><figcaption><span>PhotoManager.m</span></figcaption><table><tr><td class="code"><pre><div class="line"></div><div class="line">- (<span class="keyword">void</span>)addPhoto:(Photo *)photo</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (photo) &#123;</div><div class="line">        [_photosArray addObject:photo];</div><div class="line">        <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</div><div class="line">            [<span class="keyword">self</span> postContentAddedNotification];</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">NSArray</span> *)photos</div><div class="line">&#123;</div><div class="line">  <span class="keyword">return</span> [<span class="built_in">NSArray</span> arrayWithArray:_photosArray];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>dispatch_barrier æœ€å¥½ä½¿ç”¨åœ¨ Custom Concurrent Queue</strong></p>
<ul>
<li>Custom Serial Queue: A bad choice here; barriers wonâ€™t do anything helpful since a serial queue executes one operation at a time anyway.</li>
<li>Global Concurrent Queue: Use caution here; this probably isnâ€™t the best idea since other systems might be using the queues and you donâ€™t want to monopolize them for your own purposes.</li>
<li>Custom Concurrent Queue: This is a great choice for atomic or critical areas of code. Anything youâ€™re setting or instantiating that needs to be thread safe is a great candidate for a barrier.</li>
</ul>
<p>ä¿®æ­£</p>
<figure class="highlight objc"><figcaption><span>PhotoManager.m</span></figcaption><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">PhotoManager</span> ()</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>,<span class="keyword">readonly</span>) <span class="built_in">NSMutableArray</span> *photosArray;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">dispatch_queue_t</span> concurrentPhotoQueue; <span class="comment">///&lt; Add this</span></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// ADD THIS:</span></div><div class="line">sharedPhotoManager-&gt;_concurrentPhotoQueue = dispatch_queue_create(<span class="string">"com.selander.GooglyPuff.photoQueue"</span>,DISPATCH_QUEUE_CONCURRENT); </div><div class="line">                                                    </div><div class="line">- (<span class="keyword">void</span>)addPhoto:(Photo *)photo</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (photo) &#123; <span class="comment">// 1</span></div><div class="line">        dispatch_barrier_async(<span class="keyword">self</span>.concurrentPhotoQueue, ^&#123; <span class="comment">// 2 </span></div><div class="line">            [_photosArray addObject:photo]; <span class="comment">// 3</span></div><div class="line">            <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123; <span class="comment">// 4</span></div><div class="line">                [<span class="keyword">self</span> postContentAddedNotification]; </div><div class="line">            &#125;);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">NSArray</span> *)photos</div><div class="line">&#123;</div><div class="line">    __block <span class="built_in">NSArray</span> *array; <span class="comment">// 1</span></div><div class="line">    <span class="built_in">dispatch_sync</span>(<span class="keyword">self</span>.concurrentPhotoQueue, ^&#123; <span class="comment">// 2</span></div><div class="line">        array = [<span class="built_in">NSArray</span> arrayWithArray:_photosArray]; <span class="comment">// 3</span></div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">return</span> array;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="dispatch-sync">dispatch_sync</h3>
<p>åœ¨è®€å–æ™‚ï¼Œreader function æ²’returnæ™‚æ˜¯ç„¡æ•ˆçš„ï¼Œæ‰€ä»¥æ¡ç”¨<code>dispatch_sync</code></p>
<p>è®“ read ä½¿ç”¨ sync ä¸”èˆ‡ write åœ¨åŒä¸€å€‹ concurrent queeue æ˜¯ç¢ºä¿ read ï¼† wirte æœ‰é †åºï¼Œä¸”é¿å…å¤š thread è®€å¯«ã€‚</p>
<p><strong>dispatch_sync æœ€å¥½ä½¿ç”¨åœ¨ Custom Concurrent Queue</strong></p>
<ul>
<li>Custom Serial Queue: Be VERY careful in this situation; if youâ€™re running in a queue and call dispatch_sync targeting the same queue, you will definitely create a deadlock.</li>
<li>Main Queue (Serial): Be VERY careful for the same reasons as above; this situation also has potential for a deadlock condition.</li>
<li>Concurrent Queue: This is a good candidate to sync work through dispatch barriers or when waiting for a task to complete so you can perform further processing.</li>
</ul>
<h3 id="å…¨éƒ¨åœ–ç‰‡ä¸‹è¼‰å®Œå¾Œæç¤º-dispatch-group">å…¨éƒ¨åœ–ç‰‡ä¸‹è¼‰å®Œå¾Œæç¤º dispatch_group</h3>
<figure class="highlight objc"><figcaption><span>PhotoManager.m</span></figcaption><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)downloadPhotosWithCompletionBlock:(BatchPhotoDownloadingCompletionBlock)completionBlock</div><div class="line">&#123;</div><div class="line">    <span class="built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, <span class="number">0</span>), ^&#123; <span class="comment">// 1</span></div><div class="line"> </div><div class="line">        __block <span class="built_in">NSError</span> *error;</div><div class="line">        dispatch_group_t downloadGroup = dispatch_group_create(); <span class="comment">// 2</span></div><div class="line"> </div><div class="line">        <span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</div><div class="line">            <span class="built_in">NSURL</span> *url;</div><div class="line">            <span class="keyword">switch</span> (i) &#123;</div><div class="line">                <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">                    url = [<span class="built_in">NSURL</span> URLWithString:kOverlyAttachedGirlfriendURLString];</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">                    url = [<span class="built_in">NSURL</span> URLWithString:kSuccessKidURLString];</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">                    url = [<span class="built_in">NSURL</span> URLWithString:kLotsOfFacesURLString];</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">default</span>:</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line"> </div><div class="line">            dispatch_group_enter(downloadGroup); <span class="comment">// 3</span></div><div class="line">            Photo *photo = [[Photo alloc] initwithURL:url</div><div class="line">                                  withCompletionBlock:^(<span class="built_in">UIImage</span> *image, <span class="built_in">NSError</span> *_error) &#123;</div><div class="line">                                      <span class="keyword">if</span> (_error) &#123;</div><div class="line">                                          error = _error;</div><div class="line">                                      &#125;</div><div class="line">                                      dispatch_group_leave(downloadGroup); <span class="comment">// 4</span></div><div class="line">                                  &#125;];</div><div class="line"> </div><div class="line">            [[PhotoManager sharedManager] addPhoto:photo];</div><div class="line">        &#125;</div><div class="line">        dispatch_group_wait(downloadGroup, DISPATCH_TIME_FOREVER); <span class="comment">// 5</span></div><div class="line">        <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123; <span class="comment">// 6</span></div><div class="line">            <span class="keyword">if</span> (completionBlock) &#123; <span class="comment">// 7</span></div><div class="line">                completionBlock(error);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>dispatch_group çš†å¯ä½¿ç”¨åœ¨å„ç¨® Queue</strong></p>
<ul>
<li>Custom Serial Queue: This is a good candidate for notifications when a group of tasks completes.</li>
<li>Main Queue (Serial): This is a good candidate as well in this scenario. You should be wary of using this on the main queue if you are waiting synchronously for the completion of all work since you donâ€™t want to hold up the main thread. However, the asynchronous model is an attractive way to update the UI once several long-running tasks finish such as network calls.</li>
<li>Concurrent Queue: This as well is a good candidate for dispatch groups and completion notifications.</li>
</ul>
<p><strong>æ¯”è¼ƒç°¡æ½”æ–¹å¼</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"></div><div class="line">- (<span class="keyword">void</span>)downloadPhotosWithCompletionBlock:(BatchPhotoDownloadingCompletionBlock)completionBlock</div><div class="line">&#123;</div><div class="line">    <span class="comment">// 1</span></div><div class="line">    __block <span class="built_in">NSError</span> *error;</div><div class="line">    dispatch_group_t downloadGroup = dispatch_group_create(); </div><div class="line"> </div><div class="line">    <span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</div><div class="line">        <span class="built_in">NSURL</span> *url;</div><div class="line">        <span class="keyword">switch</span> (i) &#123;</div><div class="line">            <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">                url = [<span class="built_in">NSURL</span> URLWithString:kOverlyAttachedGirlfriendURLString];</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">                url = [<span class="built_in">NSURL</span> URLWithString:kSuccessKidURLString];</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">                url = [<span class="built_in">NSURL</span> URLWithString:kLotsOfFacesURLString];</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">default</span>:</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line"> </div><div class="line">        dispatch_group_enter(downloadGroup); <span class="comment">// 2</span></div><div class="line">        Photo *photo = [[Photo alloc] initwithURL:url</div><div class="line">                              withCompletionBlock:^(<span class="built_in">UIImage</span> *image, <span class="built_in">NSError</span> *_error) &#123;</div><div class="line">                                  <span class="keyword">if</span> (_error) &#123;</div><div class="line">                                      error = _error;</div><div class="line">                                  &#125;</div><div class="line">                                  dispatch_group_leave(downloadGroup); <span class="comment">// 3</span></div><div class="line">                              &#125;];</div><div class="line"> </div><div class="line">        [[PhotoManager sharedManager] addPhoto:photo];</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    dispatch_group_notify(downloadGroup, dispatch_get_main_queue(), ^&#123; <span class="comment">// 4</span></div><div class="line">        <span class="keyword">if</span> (completionBlock) &#123;</div><div class="line">            completionBlock(error);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="åŒæ™‚é€²è¡Œ-for-loop-dispatch-apply">åŒæ™‚é€²è¡Œ for loop  dispatch_apply</h3>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)downloadPhotosWithCompletionBlock:(BatchPhotoDownloadingCompletionBlock)completionBlock</div><div class="line">&#123;</div><div class="line">    __block <span class="built_in">NSError</span> *error;</div><div class="line">    dispatch_group_t downloadGroup = dispatch_group_create();</div><div class="line"> </div><div class="line">    dispatch_apply(<span class="number">3</span>, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, <span class="number">0</span>), ^(size_t i) &#123;</div><div class="line"> </div><div class="line">        <span class="built_in">NSURL</span> *url;</div><div class="line">        <span class="keyword">switch</span> (i) &#123;</div><div class="line">            <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">                url = [<span class="built_in">NSURL</span> URLWithString:kOverlyAttachedGirlfriendURLString];</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">                url = [<span class="built_in">NSURL</span> URLWithString:kSuccessKidURLString];</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">                url = [<span class="built_in">NSURL</span> URLWithString:kLotsOfFacesURLString];</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">default</span>:</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line"> </div><div class="line">        dispatch_group_enter(downloadGroup);</div><div class="line">        Photo *photo = [[Photo alloc] initwithURL:url</div><div class="line">                              withCompletionBlock:^(<span class="built_in">UIImage</span> *image, <span class="built_in">NSError</span> *_error) &#123;</div><div class="line">                                  <span class="keyword">if</span> (_error) &#123;</div><div class="line">                                      error = _error;</div><div class="line">                                  &#125;</div><div class="line">                                  dispatch_group_leave(downloadGroup);</div><div class="line">                              &#125;];</div><div class="line"> </div><div class="line">        [[PhotoManager sharedManager] addPhoto:photo];</div><div class="line">    &#125;);</div><div class="line"> </div><div class="line">    dispatch_group_notify(downloadGroup, dispatch_get_main_queue(), ^&#123;</div><div class="line">        <span class="keyword">if</span> (completionBlock) &#123;</div><div class="line">            completionBlock(error);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½†å¯« app æ™‚é–“æœ‰é™ï¼Œé™¤éåœ¨éå¸¸å¤§çš„ set ä¸­ï¼Œå¦å‰‡ä¸è¦å¤ª crazyã€‚</p>
<h3 id="semaphores">Semaphores</h3>
<p>å•é¡Œï¼šå¤ªæµªè²» cpu</p>
<figure class="highlight objc"><figcaption><span>GooglyPuffTests.m</span></figcaption><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)downloadImageURLWithString:(<span class="built_in">NSString</span> *)URLString</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:URLString];</div><div class="line">    __block <span class="built_in">BOOL</span> isFinishedDownloading = <span class="literal">NO</span>;</div><div class="line">    __unused Photo *photo = [[Photo alloc]</div><div class="line">                             initwithURL:url</div><div class="line">                             withCompletionBlock:^(<span class="built_in">UIImage</span> *image, <span class="built_in">NSError</span> *error) &#123;</div><div class="line">                                 <span class="keyword">if</span> (error) &#123;</div><div class="line">                                     <span class="built_in">XCTFail</span>(<span class="string">@"%@ failed. %@"</span>, URLString, error);</div><div class="line">                                 &#125;</div><div class="line">                                 isFinishedDownloading = <span class="literal">YES</span>;</div><div class="line">                             &#125;];</div><div class="line"> </div><div class="line">    <span class="keyword">while</span> (!isFinishedDownloading) &#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>dispatch_semaphore_create æ–¹å¼</p>
<figure class="highlight objc"><figcaption><span>GooglyPuffTests.m</span></figcaption><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)downloadImageURLWithString:(<span class="built_in">NSString</span> *)URLString</div><div class="line">&#123;</div><div class="line">    <span class="comment">// 1</span></div><div class="line">    dispatch_semaphore_t semaphore = dispatch_semaphore_create(<span class="number">0</span>);</div><div class="line"> </div><div class="line">    <span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:URLString];</div><div class="line">    __unused Photo *photo = [[Photo alloc]</div><div class="line">                             initwithURL:url</div><div class="line">                             withCompletionBlock:^(<span class="built_in">UIImage</span> *image, <span class="built_in">NSError</span> *error) &#123;</div><div class="line">                                 <span class="keyword">if</span> (error) &#123;</div><div class="line">                                     <span class="built_in">XCTFail</span>(<span class="string">@"%@ failed. %@"</span>, URLString, error);</div><div class="line">                                 &#125;</div><div class="line"> </div><div class="line">                                 <span class="comment">// 2</span></div><div class="line">                                 dispatch_semaphore_signal(semaphore);</div><div class="line">                             &#125;];</div><div class="line"> </div><div class="line">    <span class="comment">// 3</span></div><div class="line">    dispatch_time_t timeoutTime = dispatch_time(DISPATCH_TIME_NOW, kDefaultTimeoutLengthInNanoSeconds);</div><div class="line">    <span class="keyword">if</span> (dispatch_semaphore_wait(semaphore, timeoutTime)) &#123;</div><div class="line">        <span class="built_in">XCTFail</span>(<span class="string">@"%@ timed out"</span>, URLString);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="dispatch-source">dispatch_source</h3>
<p>è »è¤‡é›œçš„â€¦</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)viewDidLoad</div><div class="line">&#123;</div><div class="line">  [<span class="keyword">super</span> viewDidLoad];</div><div class="line"> </div><div class="line">  <span class="comment">// 1</span></div><div class="line">  <span class="meta">#if DEBUG</span></div><div class="line">      <span class="comment">// 2</span></div><div class="line">      <span class="built_in">dispatch_queue_t</span> queue = dispatch_get_main_queue();</div><div class="line"> </div><div class="line">      <span class="comment">// 3</span></div><div class="line">      <span class="keyword">static</span> dispatch_source_t source = <span class="literal">nil</span>;</div><div class="line"> </div><div class="line">      <span class="comment">// 4</span></div><div class="line">      __<span class="keyword">typeof</span>(<span class="keyword">self</span>) __<span class="keyword">weak</span> weakSelf = <span class="keyword">self</span>;</div><div class="line"> </div><div class="line">      <span class="comment">// 5</span></div><div class="line">      <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">      <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">          <span class="comment">// 6</span></div><div class="line">          source = dispatch_source_create(DISPATCH_SOURCE_TYPE_SIGNAL, SIGSTOP, <span class="number">0</span>, queue);</div><div class="line"> </div><div class="line">          <span class="comment">// 7</span></div><div class="line">          <span class="keyword">if</span> (source)</div><div class="line">          &#123;</div><div class="line">              <span class="comment">// 8</span></div><div class="line">              dispatch_source_set_event_handler(source, ^&#123;</div><div class="line">                  <span class="comment">// 9</span></div><div class="line">                  <span class="built_in">NSLog</span>(<span class="string">@"Hi, I am: %@"</span>, weakSelf);</div><div class="line">              &#125;);</div><div class="line">              dispatch_resume(source); <span class="comment">// 10</span></div><div class="line">          &#125;</div><div class="line">      &#125;);</div><div class="line">  <span class="meta">#endif</span></div><div class="line"> </div><div class="line">  <span class="comment">// The other stuff</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åƒè€ƒ &lt;a href=&quot;http://www.raywenderlich.com/60749/grand-central-dispatch-in-depth-part-1&quot;&gt;Grand Central Dispatch In-Depth&lt;/a&gt; çš„ç­†è¨˜ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Critical Section&lt;/li&gt;
&lt;li&gt;Race Condition&lt;/li&gt;
&lt;li&gt;Deadlock&lt;/li&gt;
&lt;li&gt;Context Switch&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="iOS" scheme="http://chadchang.github.io/tags/iOS/"/>
    
      <category term="GCD" scheme="http://chadchang.github.io/tags/GCD/"/>
    
  </entry>
  
  <entry>
    <title>Constants</title>
    <link href="http://chadchang.github.io/2014/03/30/constants/"/>
    <id>http://chadchang.github.io/2014/03/30/constants/</id>
    <published>2014-03-30T06:06:00.000Z</published>
    <updated>2016-11-18T14:28:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>Objective-C çš„ constants ä¹Ÿæ˜¯æœ‰å­¸å•çš„</p>
<p>å¸¸å¸¸æ˜¯ç”¨ <code>#define myConstants var</code> ä¾†è™•ç†ä¸€äº›è®Šæ•¸ï¼Œä½†æ›´å¥½çš„ä½œæ³•æ˜¯ç”¨ const</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// Constants.h</span></div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> MY_CONSTANT;</div><div class="line"></div><div class="line"><span class="comment">// Constants.m</span></div><div class="line"><span class="built_in">NSString</span> * <span class="keyword">const</span> MY_CONSTANT = <span class="string">@"my_constant"</span>;</div></pre></td></tr></table></figure>
<p>ç•¶å¸Œæœ›æ­¤è®Šæ•¸ä¸ç‚º global æ™‚ï¼Œå‰‡ç”¨ static</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// Constants.m</span></div><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> CONSTANT = <span class="string">@"my_constant"</span>;</div></pre></td></tr></table></figure>
<p><code>#define</code> åœ¨ code ä¸­æ˜¯ç”¨å–ä»£çš„æ–¹å¼ï¼Œcompilerä¹Ÿæ²’è¾¦æ³•åš type æª¢æŸ¥ï¼Œ<code>stringInstance == strConstant</code> çš„æ–¹å¼ä¹Ÿæ¯” #define ä¸­ç”¨<code>isEqualToString</code> å¿«</p>
<p>ç•¶è¦å®£å‘Š integer æ™‚ï¼Œapple å»ºè­°ç”¨</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="built_in">NSInteger</span> <span class="keyword">const</span> counter = <span class="number">0</span>;</div></pre></td></tr></table></figure>
<p>ä½†åœ¨loopä¸­æœƒæœ‰è­¦å‘Š<code>Assignment of read-only variable â€˜counterâ€™</code>ï¼Œéœ€è¦ç”¨ä»¥ä¸‹æ–¹å¼</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">int</span> counter = <span class="number">0</span>;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)showTimer &#123;</div><div class="line">counter += <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Ref:<br>
<a href="http://webbuilders.wordpress.com/2011/03/02/constant-in-objective-c/" target="_blank" rel="external">Constant in Objective-C</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Objective-C çš„ constants ä¹Ÿæ˜¯æœ‰å­¸å•çš„&lt;/p&gt;
&lt;p&gt;å¸¸å¸¸æ˜¯ç”¨ &lt;code&gt;#define myConstants var&lt;/code&gt; ä¾†è™•ç†ä¸€äº›è®Šæ•¸ï¼Œä½†æ›´å¥½çš„ä½œæ³•æ˜¯ç”¨ const&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;
    
    </summary>
    
    
      <category term="iOS" scheme="http://chadchang.github.io/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>import headeræ™‚ç„¡æ³•æ‰¾åˆ°cocoapods ä½¿ç”¨çš„framework header</title>
    <link href="http://chadchang.github.io/2013/10/25/import-headershi-wu-fa-zhao-dao-cocoapods-shi-yong-de-framework-header/"/>
    <id>http://chadchang.github.io/2013/10/25/import-headershi-wu-fa-zhao-dao-cocoapods-shi-yong-de-framework-header/</id>
    <published>2013-10-25T04:30:00.000Z</published>
    <updated>2016-11-18T14:41:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ .h file ä¸­æƒ³è¦ import cocoapods ä¸­çš„ lib æ™‚ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œå¯ä»¥åœ¨ user header search path ä¸­åŠ ä¸Š<code>&quot;${PODS_ROOT}/BuildHeaders&quot;</code>ï¼Œä¸¦è¨­ç‚º recursiveã€‚</p>
<p>Reference:</p>
<p><a href="http://stackoverflow.com/questions/12002905/ios-build-fails-with-cocoapods-cannot-find-header-files" target="_blank" rel="external">http://stackoverflow.com/questions/12002905/ios-build-fails-with-cocoapods-cannot-find-header-files</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ .h file ä¸­æƒ³è¦ import cocoapods ä¸­çš„ lib æ™‚ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œå¯ä»¥åœ¨ user header search path ä¸­åŠ ä¸Š&lt;code&gt;&amp;quot;${PODS_ROOT}/BuildHeaders&amp;quot;&lt;/code&gt;ï¼Œä¸¦è¨­ç‚º recur
    
    </summary>
    
    
      <category term="iOS" scheme="http://chadchang.github.io/tags/iOS/"/>
    
      <category term="CocoaPods" scheme="http://chadchang.github.io/tags/CocoaPods/"/>
    
  </entry>
  
  <entry>
    <title>Heroku : Sorry , I cannot find /</title>
    <link href="http://chadchang.github.io/2012/02/24/sorry/"/>
    <id>http://chadchang.github.io/2012/02/24/sorry/</id>
    <published>2012-02-24T09:12:00.000Z</published>
    <updated>2016-11-18T14:30:23.000Z</updated>
    
    <content type="html"><![CDATA[<p><font color="red">Sorry, I cannot find /</font></p>
<p>å› ç‚ºä¸€å †å¥‡æ€ªå•é¡ŒæŠŠ heroku é‡è£ä¹‹å¾Œï¼Œdeploy ä¸Šå»ä¸€ç›´å‡ºç¾é€™å•é¡Œï¼Œæäº†åŠå¤©æ‰ç™¼ç¾è¦æŠŠ .gitignore çš„ <strong><strong>public</strong></strong> ç§»é™¤ï¼Œå¦å‰‡heroku æ²’è¾¦æ³•è®€å–åˆ°ï¼Œä¸€å€‹ä¸‹åˆåˆé€™æ¨£æ²’äº†â€¦QQ</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;font color=&quot;red&quot;&gt;Sorry, I cannot find /&lt;/font&gt;&lt;/p&gt;
&lt;p&gt;å› ç‚ºä¸€å †å¥‡æ€ªå•é¡ŒæŠŠ heroku é‡è£ä¹‹å¾Œï¼Œdeploy ä¸Šå»ä¸€ç›´å‡ºç¾é€™å•é¡Œï¼Œæäº†åŠå¤©æ‰ç™¼ç¾è¦æŠŠ .gitignore çš„ &lt;strong&gt;&lt;strong&gt;publ
    
    </summary>
    
    
      <category term="Heroku" scheme="http://chadchang.github.io/tags/Heroku/"/>
    
  </entry>
  
  <entry>
    <title>Xcode 4.3 ç™¼ä½ˆ</title>
    <link href="http://chadchang.github.io/2012/02/24/xcode-4-dot-3fa-bu/"/>
    <id>http://chadchang.github.io/2012/02/24/xcode-4-dot-3fa-bu/</id>
    <published>2012-02-24T03:52:00.000Z</published>
    <updated>2016-11-18T14:30:54.000Z</updated>
    
    <content type="html"><![CDATA[<p>å°±ç®— Xcode å·²ç¶“åœ¨ Mac Store äº†ï¼Œæœ‰æ–°ç‰ˆçš„é‚„æ˜¯ä¸æœƒæç¤ºæ›´æ–°ï¼Œç”¨äº†æœ€æ–° 4.3 ç‰ˆç™¼ç¾ä¸€äº›ä¸ä¸€æ¨£ï¼š</p>
<a id="more"></a>
<ol>
<li>New file å‡ºä¾†çš„ template åˆä¸åŒäº†ï¼Œå¥½åƒæ¯æ¬¡æ”¹ç‰ˆéƒ½ä¸åŒâ€¦Orz</li>
<li>archive å¾Œé€å¯©çš„ UI èª¿æ•´</li>
<li>New file æ™‚æŠŠ view è·Ÿ controler æ•´åˆåœ¨ä¸€èµ·ï¼Œæœƒè‡ªå‹•æŠŠ_ViewController_åŠ åˆ°æª”åä¹‹å¾Œï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¼¸å…¥è¦ç¹¼æ‰¿çš„ classï¼Œä½†æœ‰ä¸€é»ä¸æ–¹ä¾¿çš„æ˜¯å¦‚æœä¸æ˜¯ç¹¼æ‰¿ UIViewControllerï¼Œå°±ä¸èƒ½ç”¢ç”Ÿ.xibâ€¦Orz</li>
</ol>
<p>ç›®å‰ç™¼ç¾çš„æ˜¯é€™æ¨£ï¼Œ<strong><strong><code>markdown å­¸ç¿’ä½¿ç”¨ä¸­</code></strong></strong>~</p>
<p><strong><em>2012.02.25 update</em></strong></p>
<ol>
<li>ä¸‹æ–¹ console çš„éƒ¨ä»½å¯ä»¥è¨­å®šé è¨­ä½ç½®äº†ï¼Œé¡ä¼¼androidå¯ä»¥æ‰‹å‹•ç™¼é€æƒ³è¦è¨­å®šçš„ GPS çµ¦ device åŠŸèƒ½  (çµ‚æ–¼â€¦)</li>
<li>æ”¶åˆ° Notification æ™‚ï¼Œè£¡é¢çš„ NSLog åœ¨ console å°ä¸å‡ºä¾†ï¼Œä¸éçœ‹ device å…§çš„ console log åˆæœ‰â€¦</li>
</ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å°±ç®— Xcode å·²ç¶“åœ¨ Mac Store äº†ï¼Œæœ‰æ–°ç‰ˆçš„é‚„æ˜¯ä¸æœƒæç¤ºæ›´æ–°ï¼Œç”¨äº†æœ€æ–° 4.3 ç‰ˆç™¼ç¾ä¸€äº›ä¸ä¸€æ¨£ï¼š&lt;/p&gt;
    
    </summary>
    
    
      <category term="iOS" scheme="http://chadchang.github.io/tags/iOS/"/>
    
      <category term="Xcode" scheme="http://chadchang.github.io/tags/Xcode/"/>
    
  </entry>
  
  <entry>
    <title>Review Clock v1.0 ä¸Šæ¶å•¦!!! (å·²ä¸‹æ¶)</title>
    <link href="http://chadchang.github.io/2011/12/18/review-clcok-v1-dot-0shang-jia-la/"/>
    <id>http://chadchang.github.io/2011/12/18/review-clcok-v1-dot-0shang-jia-la/</id>
    <published>2011-12-18T07:01:00.000Z</published>
    <updated>2016-11-18T14:29:17.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="http://itunes.apple.com/tw/app/review-clock/id488483008?mt=8" target="_blank" rel="external">ä¸‹è¼‰ç¶²å€</a></p>
<p>è¢«å…©é€å…©é€€å¾Œçµ‚æ–¼æå®šäº†ï¼Œå¸Œæœ›é€™æ˜¯çœŸçš„å°ç”Ÿæ´»æœ‰å¹«åŠ©çš„å¯¦ç”¨appï¼Œ<br>
ä¹Ÿå¸Œæœ›å¤§å®¶å–œæ­¡ï¼Œä¸¦åŠªåŠ›æ”¹é€²ç•¶ä¸­ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;http://itunes.apple.com/tw/app/review-clock/id488483008?mt=8&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ä¸‹è¼‰ç¶²å€&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¢«å…©é€å…©é€€å¾Œçµ‚æ–¼æå®šäº†ï¼Œå¸Œæœ›é€™æ˜¯çœŸçš„å°
    
    </summary>
    
    
      <category term="Review Clock" scheme="http://chadchang.github.io/tags/Review-Clock/"/>
    
  </entry>
  
</feed>
